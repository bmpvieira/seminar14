## Crowdsourcing gene predictions & estimating population sizes

[bmpvieira.com/seminar14](//bmpvieira.com/seminar14)


Bruno Vieira | <i class="fa fa-twitter"></i> [@bmpvieira](//twitter.com/bmpvieira)

<img src="img/Queen_Mary,_University_of_London_logo.svg" alt="QMUL" style="float: left; padding: 1%; max-width: 26%; vertical-align: text-bottom;" />
<img src="img/new-bbsrc-colour-cmyk.svg" alt="BBSRC" style="float: left; padding: 1.5%; max-width: 25%; vertical-align: text-bottom;" />

---
## Bioinformatics and Population Genomics

---

### Initially address two issues

* Scaling gene prediction
* *N<span style="vertical-align: sub; font-size: .8em;">e</span>* inference in insects with the Pairwise Sequentially Markovian Coalescent (PSMC) method.

---

## Two Projects <br><br> Afra & PSMC

---

### Afra

> Web application to crowdsource gene prediction

<i class="fa fa-github-alt"></i> [github.com/yeban/afra](//github.com/yeban/afra)

---

### PSMC

> Pairwise Sequentially Markovian Coalescent¹ method on insect genomes for inference of the population size history

<i class="fa fa-github-alt"></i> [github.com/lh3/psmc](//https://github.com/lh3/psmc)

<hr>
<small>
¹ Li, H., & Durbin, R. (2011). Inference of human population history from individual whole-genome sequences. *Nature, 475* (7357), 493–6. [doi:10.1038/nature10231](//dx.doi.org/10.1038/nature10231)
</small>

---

## Afra

<img src="img/anurag_afra_dashboard.png" alt="Afra's current dashboard" style="max-width: 90%" />

---

### Afra

> <strong><span class="fragment highlight-current-blue">Web application</span> to crowdsource gene prediction</strong>

<i class="fa fa-github-alt"></i> [github.com/yeban/afra](//github.com/yeban/afra)

---

## Web Application?

---

### Gmail, Facebook, etc.

<img src="img/webapps.png" alt="Web Apps" style="max-width: 90%;" />

---

### Afra

> <strong>Web application to <span class="fragment highlight-current-blue">crowdsource</span> gene prediction</strong>

<i class="fa fa-github-alt"></i> [github.com/yeban/afra](//github.com/yeban/afra)

---

## Crowdsource?

---

### Crowd + Outsource

<!-- <img src="img/crowd.jpg" alt="From: http://www.flickr.com/photos/jamescridland/613445810/sizes/z/" style="max-width: 90%;" /> -->


<section data-background="img/crowd-original-background.jpg">
  <img class="stretch" src="img/crowd.jpg" alt="From: http://www.flickr.com/photos/jamescridland/613445810/sizes/z/" style="max-width: 100%;" />
</section>

---

### Citizen Science

<!-- <img src="img/citizen_science-background.jpg" alt="From: http://www.jamesborrell.com/10-lessons-from-a-year-of-citizen-science-my-talk-from-the-citizen-cyberscience-summit" style="max-width: 90%;" /> -->

<section data-background="img/citizen_science-background.jpg">
  <img src="img/citizen_science.jpg" alt="From: http://www.jamesborrell.com/10-lessons-from-a-year-of-citizen-science-my-talk-from-the-citizen-cyberscience-summit/" style="max-width: 75%;" />
  <p>
    <small>
      James Borrell | <i class="fa fa-twitter"></i> [@James_Borrell](//twitter.com/James_Borrell)
      <br>
      Citizen Cyberscience Summit 2014 | <i class="fa fa-twitter"></i> [#ccs14](//twitter.com/#ccs14)
    </small>
  </p>
</section>


---

### Self-reward helping Science

Zooniverse success

<img src="img/zooniverse.png" alt="From: http://infobeautiful2.s3.amazonaws.com/goggle_boxes.png" style="max-width: 90%;" />

---

### Lazy people don't care...

<br>
<img class="stretch" src="img/lazy_cat.jpg" alt="From: http://www.jenniferhudson.com/us/photos/my-lazy-cat" style="max-width: 100%;" />

---


### Cognitive surplus

<img src="img/goggle_boxes.png" alt="From: http://infobeautiful2.s3.amazonaws.com/goggle_boxes.png" style="max-width: 90%;" />


---

## Gamification

---

### Useless game | Flappy bird

50 milion downloads | $50 000 per day

<img src="img/flappy.png" alt="Flappy bird screenshot" style="max-width: 60%;" />

<small>
<i class="fa fa-link"></i> [flappybird.io](//http://flappybird.io)
</small>

---

### Useful | Genes In Space

<img src="img/cancerresearchuk.png" alt="Cancer Research UK screenshot" style="max-width: 75%;" />
<small>
<i class="fa fa-link"></i> [http://www.cancerresearchuk.org](//www.cancerresearchuk.org/support-us/play-to-cure-genes-in-space)
</small>

---

### Useful | Genes In Space

<img src="img/cancerresearchuk-science.png" alt="Flappy bird screenshot" style="max-width: 55%;" />
<small>
<i class="fa fa-link"></i> [http://www.cancerresearchuk.org](//http://scienceblog.cancerresearchuk.org/2014/02/04/download-our-revolutionary-mobile-game-to-help-speed-up-cancer-research/)
</small>

---

### Afra

> <strong>Web application to crowdsource <span class="fragment highlight-current-blue">gene prediction</span></strong>

<i class="fa fa-github-alt"></i> [github.com/yeban/afra](//github.com/yeban/afra)

---

## Gene prediction?

---

### Gene prediction

<img class="stretch" src="img/dalliance.png" alt="Dalliance screenshot" style="max-width: 75%;" />
<small>
<i class="fa fa-link"></i> [http://www.biodalliance.org/human37.html](//www.biodalliance.org/human37.html)
</small>

---

### Gene prediction models

<img style="max-width: 70%;" src="img/gene-prediction-models.png" alt="Gene prediction models" />


<hr>
<small>

 Sleator, R. D. (2010). An overview of the current status of eukaryote gene prediction strategies. *Gene, 461* (1-2), 1–4. [doi:10.1016/j.gene.2010.04.008](//dx.doi.org/10.1016/j.gene.2010.04.008)

</small>

---

### MAKER

<img class="stretch" src="img/MAKER.jpg" alt="MAKER Apollo view" style="width: 80%;" />
<small>
<i class="fa fa-link"></i> [http://www.gmod.org/wiki/MAKER](//www.gmod.org/wiki/MAKER)
</small>

<!-- also see http://gmod.org/wiki/File:Comparison.png -->

---

### Manual curation won't scale...

<img class="stretch" src="img/ngs.png" alt="From: http://aws.labome.com/figure/te-203-10.png" style="width: 80%;" />

---

### Afra Demo

<img style="max-width: 80%;" src="img/afra-annotation-demo.mov.gif" alt="Demonstration of Afra" />

<i class="fa fa-github-alt"></i> [afra.sbcs.qmul.ac.uk](http://afra.sbcs.qmul.ac.uk)

---

## Previous work

---

### Main developer

![Anurag Priyam](img/anurag.jpeg)

Anurag Priyam | <i class="fa fa-twitter"></i> [@yeban](//twitter.com/yeban)

---

### WebApollo

<img style="max-width: 50%;" src="img/WebApollo.png" alt="WebApollo" />

<i class="fa fa-github-alt"></i> [github.com/gmod/apollo](//github.com/gmod/apollo)

<i class="fa fa-link"></i> [apollo.berkeleybop.org](//apollo.berkeleybop.org)

---

## Current work

---

### Gamification

Dashboad mockup

<img style="max-width: 80%;" src="img/2013-11-12_afra_dashboard_mockup.png" alt="Dashboard mockup" />

---
### Gamification

Dashboard HTML5 (incomplete)

<img style="max-height: 100%;" src="img/2013-12-09_afra_dashboard_html.png" alt="Dashboard HTML5" />


---

## Priority change

---

### Annotation editing feature far from completion due to complexity of the project

---

### Software Stack

<img class="fragment" src="img/stack_gmod.png" alt="BBSRC" style="float: left; padding: 1%; max-width: 45%; vertical-align: text-bottom;" />
<img class="fragment" src="img/stack_afra.png" alt="BBSRC" style="float: left; padding: 1%; max-width: 46%; vertical-align: text-bottom;" />

<p class="fragment" style="clear: left;">
Move most of the logic to the client side (browser) for scalability
</p>

---

### Afra Stack
<div class="fragment fade-in" data-fragment-index="0">
  <div class="fragment fade-out" data-fragment-index="1">
    <img src="img/stack_bionode.png" alt="BBSRC" style="float: left; padding: 1%; max-width: 80%; vertical-align: text-bottom; position: absolute; left: 0;" />
  </div>
</div>

<div class="fragment fade-in" data-fragment-index="1">
  <img src="img/stack_bionode_highlight.png" alt="BBSRC" style="float: left; padding: 1%; max-width: 80%; vertical-align: text-bottom; position: absolute; left: 0;" />
</div>


---

### Bionode

![bionode](img/bionode.png)

<i class="fa fa-github-alt"></i> [github.com/bionode/bionode](//github.com/bionode/bionode)

---

### Gamify

* Scores
* Open Badges
* Certificates of Expertise

<br>
<img src="img/badges.png" alt="PSMC plot" style="max-width: 50%" />

<small>
<i class="fa fa-link"></i> [http://openbadges.org](//openbadges.org)
</small>

---

### Machine Learning

Use data generated by users to improve gene prediction models

<section data-background="img/machine-learning-background.png">
  <a href="//speakerdeck.com/ttfnrob/zooniverse-citizen-cyberscience-summit-2014?slide=36" target="_blank">
  <img src="img/machine-learning.png" alt="From: https://speakerdeck.com/ttfnrob/zooniverse-citizen-cyberscience-summit-2014" style="max-width: 55%;" />
  </a>
  <p>
    <small>
      Robert Simpson | <i class="fa fa-twitter"></i> [@orbitingfrog](//twitter.com/orbitingfrog)
      <br>
      Citizen Cyberscience Summit 2014 | <i class="fa fa-twitter"></i> [#ccs14](//twitter.com/#ccs14)
    </small>
  </p>
</section>


---

## PSMC

<img src="img/psmc_plot.png" alt="PSMC plot" style="max-width: 90%" />

---

### PSMC

> Pairwise Sequentially Markovian Coalescent¹ method on insect genomes for inference of the population size history

<i class="fa fa-github-alt"></i> [github.com/lh3/psmc](//https://github.com/lh3/psmc)

<hr>
<small>
¹ Li, H., & Durbin, R. (2011). Inference of human population history from individual whole-genome sequences. *Nature, 475* (7357), 493–6. [doi:10.1038/nature10231](//dx.doi.org/10.1038/nature10231)
</small>

---

### Theory

>"The PSMC infers the local time to the most recent common ancestor (TMRCA) on the basis of the local density of heterozygotes, using a hidden Markov model"

H. Li & Durbin, 2011

---

### Practice

<img class="stretch" style="max-width: 100%;" src="img/psmc.png" alt="WebApollo" />

H. Li & Durbin, 2011

---

### Previous usages

<div style="font-size:.8em;">
<ul>
<li> Evaluate the effect of historical climate changes, such as glacial periods, on a species[1]</li>
<li> Measure the impact of anthropogenic activity in the decline of species[2]</li>
<li> Discover unexpected population bottlenecks[3]</li>
<li> Detect the time of divergence between populations[4]</li>
<li> etc.
<ul>
</div>

<br>
<small>
[1]: W. Miller & Schuster, 2012; Nadachowska-Brzyska et al., 2013;  
[2]: S. Zhao et al., 2013;  
[3]: Freedman et al., 2014;  
[4]: H. Li & Durbin, 2011.
</small>

---

## Not very used on insects<span class="fragment" data-fragment-index="0">... until now!</span>
<img class="fragment" data-fragment-index="0" src="img/ant.jpg" alt="From: http://commons.wikimedia.org/wiki/File:Ant_head_closeup.jpg" style="max-width: 50%" />

---
### Use PSMC to answer some evolutionary questions

---

## In insects, does *N<span style="vertical-align: sub; font-size: .8em;">e</span>* for solitary > social?

---

### Experimental design
Run PSMC across a wide range of insects that evolved eusociality.

<img src="img/WeaverAntDefense.JPG" alt="From: http://upload.wikimedia.org/wikipedia/commons/8/85/WeaverAntDefense.JPG" style="max-width: 38%" />
<img src="img/Honeybee_landing_on_milkthistle02.jpg" alt="From: http://upload.wikimedia.org/wikipedia/commons/e/e0/Honeybee_landing_on_milkthistle02.jpg" style="max-width: 35%" />

<img src="img/Coptotermes_formosanus_shiraki_USGov_k8204-7.jpg" alt="From: http://upload.wikimedia.org/wikipedia/commons/d/d3/Coptotermes_formosanus_shiraki_USGov_k8204-7.jpg" style="max-width: 15%" />
<img src="img/Bush_Cockroach.jpg" alt="From: http://upload.wikimedia.org/wikipedia/commons/c/ca/Bush_Cockroach.jpg" style="max-width: 30%" />

---

## In ants colonies, does *N<span style="vertical-align: sub; font-size: .8em;">e</span>* for multi queen > single queen?

---
### Experimental design
Run PSMC on many ant genomes, perhaps more than the seven genomes currently sequenced and publicly available

<small>
* Jerdon's jumping ant, *Harpegnathos saltator* (Bonasio, 2010)
* Florida carpenter ant, *Camponotus floridanus* (Bonasio, 2010)
* Argentine ant, *Linepithema humile* (Smith, 2011)
* Fire ant, *Solenopsis invicta* (Wurm, 2011)
* Two leafcutter ants, *Atta cephalotes* (Suen, 2011) and *Acromyrmex echinatior* (Nygaard, 2011);
* Red harvester ant, *Pogonomyrmex barbatus* (Smith, 2011).

</small>

---
## Current work

---

### Reproducing published results to master PSMC

<div style="font-size: .8em;">
<ul>
<li>Li, H., & Durbin, R. (2011). **Inference of human population history from individual whole-genome sequences**. *Nature, 475* (7357), 493–6. [doi:10.1038/nature10231](//dx.doi.org/10.1038/nature10231)</li>

<li> Freedman, A. H., Gronau, I., Schweizer, R. M., Ortega-Del Vecchyo, D., Han, E., Silva, P. M., ... Novembre, J. (2014). **Genome Sequencing Highlights the Dynamic Early History of Dogs**. (L. Andersson, ed.)*PLoS Genetics, 10*(1), e1004016. [doi:10.1371/journal.pgen.1004016](//dx.doi.org/10.1371/journal.pgen.1004016)</li>a

</div>

---

### Thank you!

<img style="max-width: 15%;" src="img/bmpvieira.png" alt"Bruno Vieira"/>
Bruno Vieira | <i class="fa fa-twitter"></i> [@bmpvieira](//twitter.com/bmpvieira)

<img style="max-width: 15%;" src="img/anurag.jpeg" alt"Anurag Priyam" />
Anurag Priyam | <i class="fa fa-twitter"></i> [@yeban](//twitter.com/yeban)

<img style="max-width: 15%;" src="img/yannick.jpg" alt"Yannick Wurm" />
Yannick Wurm | <i class="fa fa-twitter"></i> [@yannick__](//twitter.com/yannick__)

[bmpvieira.com/seminar14](//bmpvieira.com/seminar14)

<small>
© 2014 [Bruno Vieira](//bmpvieira.com) [CC-BY 4.0](//creativecommons.org/licenses/by/4.0/deed.en_US)
</small>

---

### Summary
[bmpvieira.com/seminar14](//bmpvieira.com/seminar14)

<div style="text-align: left; line-height:2em;">

<span style="font-size: 1.2em;">Afra - crowdsource gene prediction</span>
<small>
<ul style="text-align: left; line-height:1.5em;">
<li> Address data "deluge" with crowdsourcing and gamification</li>
<li> Make WebApollo more scalable by moving logics to client side</li>
<li> Implement biological logics in JavaScript as reusable module</li>
</ul>

</small>
<span style="font-size: 1.2em;">PSMC - *N<span style="vertical-align: sub; font-size: .8em;">e</span>* history in insects</span>
<small>
<ul style="text-align: left; line-height:1.5em;">
<li> Master this method by reproducing published results</li>
<li> In insects, does *N<span style="vertical-align: sub; font-size: .8em;">e</span>* for solitary > social?</li>
<li> In ants colonies, does *N<span style="vertical-align: sub; font-size: .8em;">e</span>* for multi queen > single queen?</li>
</ul>

</small>

</div>